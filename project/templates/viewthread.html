{% extends "layout.html" %}

{% block title %}
    Thread
{% endblock %}

{% block main %}
<link href="/static/styles2.css" rel="stylesheet">
    <div class="container-fluid mt-100">
        {% for row in rows %}
        <div class="row">
            <div class="col-md-12">
                <div class="card mb-4">
                    <div class="card-header">
                        <div class="media flex-wrap w-100"> <!-- <img src="https://i.imgur.com/iNmBizf.jpg" class="d-block ui-w-40 rounded-circle" alt=""> -->
                            <div class="media-body ml-3"> <a style="text-align:left" href="javascript:void(0)" data-abc="true">{{ row["user"] }}</a>
                                <div class="text-muted small">test</div>
                            </div>
                            <div class="text-muted small ml-3">
                                <div>Posted <strong>{{ row["date"] }}</strong></div>
                                <div><strong>{{ row["likes"] }}</strong> Likes</div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body d-flex">
                        <p>{{ row["message"] }}</p>
                    </div>
                    <div class="card-footer d-flex flex-wrap justify-content-between align-items-center px-0 pt-0 pb-3">
                        <div class="px-4 pt-3">
                            <button type="button" id="reply_button" class="btn btn-primary" value="{{ row["id"] }}" onclick="replySection(this.value)"> Reply</button>
                            <button type="button" class="btn btn-success"> Like</button>
                        </div>
                    </div>
                    <div id="{{ row["id"] }}" style="display: none" class="form-group">
                        <form id="form__submit" action="/reply" method="post">
                            <label for="message">Message</label>
                            <textarea class="form-control" name="message" rows="3"></textarea>
                            <input type="hidden" name="id" value="{{ row["id"] }}">
                            <input type="hidden" name="thread_id" value="{{ row["thread_id"] }}">
                            <div class="px-4 pt-3">
                                <button onclick="submitReply()" type="button" class="btn btn-primary"> Submit</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <script>
        function replySection(clicked_value) {
            if (document.getElementById(clicked_value).style.display == "block")
            {
                document.getElementById(clicked_value).style.display = "none";
            }
            else
            {
                document.getElementById(clicked_value).style.display = "block";
            }
        }
        function submitReply() {
            let form = document.getElementById("form__submit");
            form.submit();
        }
    </script>
{% endblock %}